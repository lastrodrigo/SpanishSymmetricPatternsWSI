
(base) c:\pgrado\pc\bilm-tf-master>python bin\train_elmo.py --train_prefix=train
ing-spanish.tokenized.shuffled --vocab_file vocab-2018-9-25.txt --save_dir check
points
C:\Users\Rodri\Anaconda3\lib\site-packages\h5py\__init__.py:36: FutureWarning: C
onversion of the second argument of issubdtype from `float` to `np.floating` is
deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type
`.
  from ._conv import register_converters as _register_converters
Found 1 shards at training-spanish.tokenized.shuffled
Loading data from: training-spanish.tokenized.shuffled
Loaded 200 sentences.
Finished loading
Found 1 shards at training-spanish.tokenized.shuffled
Loading data from: training-spanish.tokenized.shuffled
Loaded 200 sentences.
Finished loading
USING SKIP CONNECTIONS
[['global_step:0', TensorShape([])],
 ['lm/CNN/W_cnn_0:0',
  TensorShape([Dimension(1), Dimension(1), Dimension(16), Dimension(32)])],
 ['lm/CNN/W_cnn_1:0',
  TensorShape([Dimension(1), Dimension(2), Dimension(16), Dimension(32)])],
 ['lm/CNN/W_cnn_2:0',
  TensorShape([Dimension(1), Dimension(3), Dimension(16), Dimension(64)])],
 ['lm/CNN/W_cnn_3:0',
  TensorShape([Dimension(1), Dimension(4), Dimension(16), Dimension(128)])],
 ['lm/CNN/W_cnn_4:0',
  TensorShape([Dimension(1), Dimension(5), Dimension(16), Dimension(256)])],
 ['lm/CNN/W_cnn_5:0',
  TensorShape([Dimension(1), Dimension(6), Dimension(16), Dimension(512)])],
 ['lm/CNN/W_cnn_6:0',
  TensorShape([Dimension(1), Dimension(7), Dimension(16), Dimension(1024)])],
 ['lm/CNN/b_cnn_0:0', TensorShape([Dimension(32)])],
 ['lm/CNN/b_cnn_1:0', TensorShape([Dimension(32)])],
 ['lm/CNN/b_cnn_2:0', TensorShape([Dimension(64)])],
 ['lm/CNN/b_cnn_3:0', TensorShape([Dimension(128)])],
 ['lm/CNN/b_cnn_4:0', TensorShape([Dimension(256)])],
 ['lm/CNN/b_cnn_5:0', TensorShape([Dimension(512)])],
 ['lm/CNN/b_cnn_6:0', TensorShape([Dimension(1024)])],
 ['lm/CNN_high_0/W_carry:0', TensorShape([Dimension(2048), Dimension(2048)])],
 ['lm/CNN_high_0/W_transform:0',
  TensorShape([Dimension(2048), Dimension(2048)])],
 ['lm/CNN_high_0/b_carry:0', TensorShape([Dimension(2048)])],
 ['lm/CNN_high_0/b_transform:0', TensorShape([Dimension(2048)])],
 ['lm/CNN_high_1/W_carry:0', TensorShape([Dimension(2048), Dimension(2048)])],
 ['lm/CNN_high_1/W_transform:0',
  TensorShape([Dimension(2048), Dimension(2048)])],
 ['lm/CNN_high_1/b_carry:0', TensorShape([Dimension(2048)])],
 ['lm/CNN_high_1/b_transform:0', TensorShape([Dimension(2048)])],
 ['lm/CNN_proj/W_proj:0', TensorShape([Dimension(2048), Dimension(512)])],
 ['lm/CNN_proj/b_proj:0', TensorShape([Dimension(512)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_0/lstm_cell/bias:0',
  TensorShape([Dimension(16384)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_0/lstm_cell/kernel:0',
  TensorShape([Dimension(1024), Dimension(16384)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_0/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(4096), Dimension(512)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_1/lstm_cell/bias:0',
  TensorShape([Dimension(16384)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_1/lstm_cell/kernel:0',
  TensorShape([Dimension(1024), Dimension(16384)])],
 ['lm/RNN_0/rnn/multi_rnn_cell/cell_1/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(4096), Dimension(512)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_0/lstm_cell/bias:0',
  TensorShape([Dimension(16384)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_0/lstm_cell/kernel:0',
  TensorShape([Dimension(1024), Dimension(16384)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_0/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(4096), Dimension(512)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_1/lstm_cell/bias:0',
  TensorShape([Dimension(16384)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_1/lstm_cell/kernel:0',
  TensorShape([Dimension(1024), Dimension(16384)])],
 ['lm/RNN_1/rnn/multi_rnn_cell/cell_1/lstm_cell/projection/kernel:0',
  TensorShape([Dimension(4096), Dimension(512)])],
 ['lm/char_embed:0', TensorShape([Dimension(261), Dimension(16)])],
 ['lm/softmax/W:0', TensorShape([Dimension(1953), Dimension(512)])],
 ['lm/softmax/b:0', TensorShape([Dimension(1953)])],
 ['train_perplexity:0', TensorShape([])]]
WARNING:tensorflow:From C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\py
thon\util\tf_should_use.py:170: initialize_all_variables (from tensorflow.python
.ops.variables) is deprecated and will be removed after 2017-03-02.
Instructions for updating:
Use `tf.global_variables_initializer` instead.
2018-09-25 22:53:29.918170: W c:\tf_jenkins\home\workspace\release-win\m\windows
\py\36\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library
wasn't compiled to use SSE instructions, but these are available on your machine
 and could speed up CPU computations.
2018-09-25 22:53:29.919265: W c:\tf_jenkins\home\workspace\release-win\m\windows
\py\36\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library
wasn't compiled to use SSE2 instructions, but these are available on your machin
e and could speed up CPU computations.
2018-09-25 22:53:29.921179: W c:\tf_jenkins\home\workspace\release-win\m\windows
\py\36\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library
wasn't compiled to use SSE3 instructions, but these are available on your machin
e and could speed up CPU computations.
2018-09-25 22:53:29.924474: W c:\tf_jenkins\home\workspace\release-win\m\windows
\py\36\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library
wasn't compiled to use SSE4.1 instructions, but these are available on your mach
ine and could speed up CPU computations.
2018-09-25 22:53:29.927739: W c:\tf_jenkins\home\workspace\release-win\m\windows
\py\36\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library
wasn't compiled to use SSE4.2 instructions, but these are available on your mach
ine and could speed up CPU computations.
2018-09-25 22:53:29.931277: W c:\tf_jenkins\home\workspace\release-win\m\windows
\py\36\tensorflow\core\platform\cpu_feature_guard.cc:45] The TensorFlow library
wasn't compiled to use AVX instructions, but these are available on your machine
 and could speed up CPU computations.
WARNING:tensorflow:Error encountered when serializing lstm_output_embeddings.
Type is unsupported, or the types of the items don't match field type in Collect
ionDef.
'list' object has no attribute 'name'
Training for 10 epochs and 10 batches
Traceback (most recent call last):
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\client\sess
ion.py", line 1139, in _do_call
    return fn(*args)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\client\sess
ion.py", line 1121, in _run_fn
    status, run_metadata)
  File "C:\Users\Rodri\Anaconda3\lib\contextlib.py", line 88, in __exit__
    next(self.gen)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\framework\e
rrors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InvalidArgumentError: Sampler's range is
 too small.
         [[Node: lm/sampled_softmax_loss/LogUniformCandidateSampler = LogUniform
CandidateSampler[num_sampled=8192, num_true=1, range_max=1953, seed=0, seed2=0,
unique=true, _device="/job:localhost/replica:0/task:0/cpu:0"](lm/Reshape_9, ^lm/
dropout/mul)]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "bin\train_elmo.py", line 73, in <module>
    main(args)
  File "bin\train_elmo.py", line 63, in main
    train(options, data, n_gpus, tf_save_dir, tf_log_dir)
  File "c:\pgrado\pc\bilm-tf-master\bin\bilm\training.py", line 861, in train
    feed_dict=feed_dict
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\client\sess
ion.py", line 789, in run
    run_metadata_ptr)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\client\sess
ion.py", line 997, in _run
    feed_dict_string, options, run_metadata)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\client\sess
ion.py", line 1132, in _do_run
    target_list, options, run_metadata)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\client\sess
ion.py", line 1152, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Sampler's range is
 too small.
         [[Node: lm/sampled_softmax_loss/LogUniformCandidateSampler = LogUniform
CandidateSampler[num_sampled=8192, num_true=1, range_max=1953, seed=0, seed2=0,
unique=true, _device="/job:localhost/replica:0/task:0/cpu:0"](lm/Reshape_9, ^lm/
dropout/mul)]]

Caused by op 'lm/sampled_softmax_loss/LogUniformCandidateSampler', defined at:
  File "bin\train_elmo.py", line 73, in <module>
    main(args)
  File "bin\train_elmo.py", line 63, in main
    train(options, data, n_gpus, tf_save_dir, tf_log_dir)
  File "c:\pgrado\pc\bilm-tf-master\bin\bilm\training.py", line 705, in train
    model = LanguageModel(options, True)
  File "c:\pgrado\pc\bilm-tf-master\bin\bilm\training.py", line 72, in __init__
    self._build()
  File "c:\pgrado\pc\bilm-tf-master\bin\bilm\training.py", line 430, in _build
    self._build_loss(lstm_outputs)
  File "c:\pgrado\pc\bilm-tf-master\bin\bilm\training.py", line 506, in _build_l
oss
    num_true=1)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\ops\nn_impl
.py", line 1268, in sampled_softmax_loss
    name=name)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\ops\nn_impl
.py", line 977, in _compute_sampled_logits
    range_max=num_classes)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\ops\candida
te_sampling_ops.py", line 138, in log_uniform_candidate_sampler
    seed2=seed2, name=name)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\ops\gen_can
didate_sampling_ops.py", line 357, in _log_uniform_candidate_sampler
    name=name)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\framework\o
p_def_library.py", line 767, in apply_op
    op_def=op_def)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\framework\o
ps.py", line 2506, in create_op
    original_op=self._default_original_op, op_def=op_def)
  File "C:\Users\Rodri\Anaconda3\lib\site-packages\tensorflow\python\framework\o
ps.py", line 1269, in __init__
    self._traceback = _extract_stack()

InvalidArgumentError (see above for traceback): Sampler's range is too small.
         [[Node: lm/sampled_softmax_loss/LogUniformCandidateSampler = LogUniform
CandidateSampler[num_sampled=8192, num_true=1, range_max=1953, seed=0, seed2=0,
unique=true, _device="/job:localhost/replica:0/task:0/cpu:0"](lm/Reshape_9, ^lm/
dropout/mul)]]


(base) c:\pgrado\pc\bilm-tf-master>
